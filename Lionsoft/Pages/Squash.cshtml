@page
@using Lionsoft.Helpers;
@using Lionsoft.Models;
@using System.Text.RegularExpressions;
@using System.Xml.XPath;
@model Lionsoft.Pages.SquashModel
@{
    ViewData["Title"] = "Squash";
    var rezonSiteParserHelper = new RezonSiteParserHelper();
    var events = rezonSiteParserHelper.GetEvents();
    var playerSiteParserHelper = new PlayerSiteParserHelper();
    var playerList = playerSiteParserHelper.GetPlayersData();
    var i = 0;
    string Concat(string text, int i) => $"{text}{i}";
}

<div class="text-center">
    @await foreach (var player in playerList)
    {
        <h1 class="display-4">@player.Name</h1>
        <a href="@player.Bo5Link" class="btn btn-info btn-sm" target="_blank">Bo5</a>
        <a href="@player.PsLink" class="btn btn-info btn-sm" target="_blank">Polski Squash</a>
        <table class="table">
            @foreach (var rank in player.Ranking)
            {
                <tr>
                    <td>@rank.Name</td>
                    <td><b>@rank.Position</b></td>
                    <td>@rank.Points</td>
                </tr>
            }
        </table>
    }
    <h1 class="display-4">Wydarzenia w Rezonie</h1>
    <div class="accordion" id="accordionEvents">
    @await foreach (var singleEvent in events)
    {
        <div class="accordion-item">
            <h2 class="accordion-header" id="@Concat("heading", i)">
                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="@Concat("#collapse", i)" aria-expanded="false" aria-controls="@Concat("collapse", i)">
                    @singleEvent.Name
                </button>
            </h2>
                <div id="@Concat("collapse", i)" class="accordion-collapse collapse" aria-labelledby="@Concat("heading", i)" data-bs-parent="#accordionEvents">
                <div class="accordion-body">
                @foreach (var link in singleEvent.Links)
                {
                    <a href="@link.Link" target="_blank" class="btn btn-info" style="margin-bottom:1px">@link.Name</a>
                }
                </div>
            </div>
        </div>
        i++;
    }
    </div>
</div>